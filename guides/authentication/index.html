<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>Hub.js Authentication | Guide | @esri/hub.js</title>
    
    <meta name="description" content="A modular, high quality toolkit for working with ArcGIS Hub">
    
    <link rel="stylesheet" href="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/css/calcite-web.min.css">
    <link rel="stylesheet" href="/hub.js/css/style.css">
    
  </head>
  <body>
  <!-- Drawer -->
    <div class="drawer drawer-left js-drawer" data-drawer="top-nav" tabindex="0">
      <nav class="drawer-nav" role="navigation">
        <aside class="side-nav">
          <h2 class="side-nav-title">@esri/hub.js</h2>
          <a href="/hub.js/guides/" class="is-active side-nav-link">Guides</a>
          <a href="/hub.js/api/" class="side-nav-link">API Reference</a>
        </aside>
      </nav>
    </div>

    <div id="page" class="wrapper">
      <!-- Sample HTML -->
      <header class="top-nav">
        <div class="grid-container">
          <div class="column-24">
            <!-- desktop sized navigation -->
            <div class="tablet-hide">
              <!-- logo / home -->
              <a href="/hub.js/" class="top-nav-title">@esri/hub.js</a>
              <!-- primary navigation sections -->
              <nav class="top-nav-list" role="navigation" aria-labelledby="topnav">
                <a href="/hub.js/guides/" class="is-active top-nav-link">Guides</a>
                <a href="/hub.js/api/" class="top-nav-link">API Reference</a>
                <a href="https://github.com/Esri/hub.js" class="top-nav-link">GitHub</a>
              </nav>
            </div>

            <!-- tablet and mobile sized navigation -->
            <div class="tablet-show top-nav-flex">
              <!-- open primary navigation drawer -->
              <nav class="top-nav-flex-list" role="navigation" aria-labelledby="topnav">
                <a href="/hub.js/" class="icon-ui-menu top-nav-link js-drawer-toggle" data-drawer="top-nav"><span class="phone-hide">Menu</span></a>
              </nav>
              <!-- logo / home -->
              <header class="top-nav-flex-title">
                <a href="/hub.js/" class="top-nav-link">@esri/hub.js</a>
              </header>
            </div>
          </div>

        </div>
      </header>


      <main id="#skip-to-content">
        
  <div class="grid-container trailer-1 leader-1">
    <div class="column-6">
      <ul class="list-plain">
        
          <li>Get Started</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/from-a-cdn/">From a CDN</a></li>
            
              <li><a href="/hub.js/guides/node/">Node.js</a></li>
            
              <li><a href="/hub.js/guides/using-es6/">Using ES6</a></li>
            
              <li><a href="/hub.js/guides/whats-new-v2-0/">What's New in v2.0.0</a></li>
            
          </ul>
        
          <li>Concepts</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/authentication/" class="is-active">Authentication</a></li>
            
              <li><a href="/hub.js/guides/sites-and-pages/">Sites and Pages</a></li>
            
              <li><a href="/hub.js/guides/teams/">Hub Teams</a></li>
            
              <li><a href="/hub.js/guides/work-with-annotations/">Map Annotations</a></li>
            
              <li><a href="/hub.js/guides/common/">Utilities</a></li>
            
              <li><a href="/hub.js/guides/operation-stack/">OperationStack</a></li>
            
              <li><a href="/hub.js/guides/e2e-tests/">E2E Testing</a></li>
            
          </ul>
        
      </ul>
    </div>

    <div class="column-18">
      <div class="panel">
        <h2>Sending Authentication to Hub.js Functions</h2>
<p>Although Hub.js is built on <a href="https://esri.github.io/arcgis-rest-js/">ArcGIS Rest Js</a> much of what Hub.js does involves complex manipulation of items and groups, and orchestration of dozens of API calls.</p>
<p>While the underlying REST Js functions typically require an <a href="https://esri.github.io/arcgis-rest-js/api/request/IRequestOptions/">IRequestOptions</a> or <a href="https://esri.github.io/arcgis-rest-js/api/request/IAuthenticationManager/">IAuthenticationManager</a>, in order to avoid re-fetching significant amounts of information about the current user and their organization, the Hub.js library functions typically require <a href="https://esri.github.io/hub.js/api/common/IHubRequestOptions/">IHubRequestOptions</a>.</p>
<p>IHubRequestOptions extends IRequestOptions with three important properties:</p>
<ul>
<li><code>isPortal</code> a flag indicating if the code is running against ArcGIS Enterprise or ArcGIS Online</li>
<li><code>hubApiUrl</code> the url to the hub api.</li>
<li><code>portalSelf</code> (optional) the entire object returned from <code>/portals/self</code>, including the <code>currentUser</code> node</li>
</ul>
<p>This information is generally available in any application that does any form of authentication against the ArcGIS Online or Enterprise APIs, and greatly reduces the amount of repetitive network requests that are required.</p>
<h3>Authenticating and Creating IHubRequestOptions</h3>
<p><strong>Note</strong> In the future Hub.js will expose a function to streamline construction of <code>IHubRequestOptions</code></p>
<p>First we need to create a <code>UserSession</code> object. Typically web applications will do this via oAuth using <a href="">related methods</a> in ArcGIS Rest Js or <a href="">Identity Manager</a> in the ArcGIS API for Javascript.
To keep things simple we'll just use a username and password</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { UserSession } <span class="hljs-keyword">from</span> <span class="hljs-string">'@esri/arcgis-rest-auth'</span>;
<span class="hljs-keyword">import</span> { getSelf } <span class="hljs-keyword">from</span> <span class="hljs-string">'@esri/arcgis-rest-portal'</span>;
<span class="hljs-keyword">import</span> { getHubApiUrlFromPortal } <span class="hljs-keyword">from</span> <span class="hljs-string">'@esri/hub-common'</span>;
<span class="hljs-keyword">import</span> { removeSite } <span class="hljs-keyword">from</span> <span class="hljs-string">'@esri/hub-sites'</span>;

<span class="hljs-keyword">const</span> session = <span class="hljs-keyword">new</span> UserSession({<span class="hljs-attr">username</span>: <span class="hljs-string">'jsmith'</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">'12345678'</span>});
<span class="hljs-comment">// now use the session to get the portal/self</span>
<span class="hljs-keyword">const</span> portalSelf = <span class="hljs-keyword">await</span> getSelf({<span class="hljs-attr">authentication</span>: session});

<span class="hljs-comment">// now construct hubRequestOptions</span>
<span class="hljs-keyword">const</span> hubRO = {
  <span class="hljs-attr">isPortal</span>: portalSelf.isPortal,
  <span class="hljs-attr">hubApiUrl</span>: getHubApiUrlFromPortal(portalSelf),
  <span class="hljs-attr">portalSelf</span>: portalSelf,
  <span class="hljs-attr">authentication</span>: session
};
<span class="hljs-comment">// now we can make hub.js calls</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> removeSite(<span class="hljs-string">'3ef'</span>, hubRO);
</code></pre>
      </div>
    </div>
  </div>

      </main>
    </div>

    <footer class="footer">
      
      <div class="panel panel-white">
        <div class="grid-container">
          <div class="column-24">
            <a href="https://github.com/Esri/hub.js" class="font-size--2">Fork this project</a>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/js/calcite-web.min.js"></script>

    <script>
       calcite.init()
    </script>

    
  </body>
</html>