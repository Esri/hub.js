<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta name="date" content="2024-01-26T18:11:49.536Z">
    <title>Queries and Filters | Guide | @esri/hub.js</title>
    
    <meta name="description" content="A modular, high quality toolkit for working with ArcGIS Hub">
    
    <link rel="stylesheet" href="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/css/calcite-web.min.css">
    <link rel="stylesheet" href="/hub.js/css/style.css">
    
  </head>
  <body>
  <!-- Drawer -->
    <div class="drawer drawer-left js-drawer" data-drawer="top-nav" tabindex="0">
      <nav class="drawer-nav" role="navigation">
        <aside class="side-nav">
          <h2 class="side-nav-title">@esri/hub.js</h2>
          <a href="/hub.js/guides/" class="is-active side-nav-link">Guides</a>
          <a href="/hub.js/api/" class="side-nav-link">API Reference</a>
        </aside>
      </nav>
    </div>

    <div id="page" class="wrapper">
      <!-- Sample HTML -->
      <header class="top-nav">
        <div class="grid-container">
          <div class="column-24">
            <!-- desktop sized navigation -->
            <div class="tablet-hide">
              <!-- logo / home -->
              <a href="/hub.js/" class="top-nav-title">@esri/hub.js</a>
              <!-- primary navigation sections -->
              <nav class="top-nav-list" role="navigation" aria-labelledby="topnav">
                <a href="/hub.js/guides/" class="is-active top-nav-link">Guides</a>
                <a href="/hub.js/api/" class="top-nav-link">API Reference</a>
                <a href="https://github.com/Esri/hub.js" class="top-nav-link">GitHub</a>
              </nav>
            </div>

            <!-- tablet and mobile sized navigation -->
            <div class="tablet-show top-nav-flex">
              <!-- open primary navigation drawer -->
              <nav class="top-nav-flex-list" role="navigation" aria-labelledby="topnav">
                <a href="/hub.js/" class="icon-ui-menu top-nav-link js-drawer-toggle" data-drawer="top-nav"><span class="phone-hide">Menu</span></a>
              </nav>
              <!-- logo / home -->
              <header class="top-nav-flex-title">
                <a href="/hub.js/" class="top-nav-link">@esri/hub.js</a>
              </header>
            </div>
          </div>

        </div>
      </header>


      <main id="#skip-to-content">
        
  <div class="grid-container trailer-1 leader-1">
    <div class="column-6">
      <ul class="list-plain">
        
          <li>Intro</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/intro/overview/">Overview</a></li>
            
              <li><a href="/hub.js/guides/intro/getting-started/">Getting Started</a></li>
            
          </ul>
        
          <li>Class Api</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/classes/overview/">Overview</a></li>
            
              <li><a href="/hub.js/guides/classes/arcgiscontext/">Authentication</a></li>
            
              <li><a href="/hub.js/guides/classes/sites/">Sites (WIP)</a></li>
            
              <li><a href="/hub.js/guides/classes/pages/">Pages (WIP)</a></li>
            
              <li><a href="/hub.js/guides/classes/initiatives/">Initiatives (WIP)</a></li>
            
              <li><a href="/hub.js/guides/classes/projects/">Projects</a></li>
            
          </ul>
        
          <li>Functional Api</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/functional/overview/">Overview</a></li>
            
              <li><a href="/hub.js/guides/functional/authentication/">Authentication</a></li>
            
              <li><a href="/hub.js/guides/functional/hub-search/">Hub Search</a></li>
            
              <li><a href="/hub.js/guides/functional/utilities/">Utilities</a></li>
            
              <li><a href="/hub.js/guides/functional/discussions/">Discussions</a></li>
            
              <li><a href="/hub.js/guides/functional/teams/">Teams</a></li>
            
              <li><a href="/hub.js/guides/functional/versioning/">Versioning</a></li>
            
          </ul>
        
          <li>Advanced</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/advanced/access-control/">Access Control</a></li>
            
              <li><a href="/hub.js/guides/advanced/permissions/">Permissions</a></li>
            
              <li><a href="/hub.js/guides/advanced/operation-stack/">OperationStack</a></li>
            
              <li><a href="/hub.js/guides/advanced/metrics/">Metrics</a></li>
            
              <li><a href="/hub.js/guides/advanced/queries-and-filters/" class="is-active">Queries & Filters</a></li>
            
              <li><a href="/hub.js/guides/advanced/catalog-collection/">Catalogs & Collections</a></li>
            
              <li><a href="/hub.js/guides/advanced/composing-workflows/">Composing Workflows</a></li>
            
          </ul>
        
          <li>Developers</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/developers/e2e-tests/">E2E Testing</a></li>
            
          </ul>
        
          <li>Legacy</li>
          <ul class="list-plain margin-left-1">
            
              <li><a href="/hub.js/guides/legacy/content-search/">Search Service</a></li>
            
              <li><a href="/hub.js/guides/legacy/sites-and-pages/">Sites and Pages</a></li>
            
          </ul>
        
      </ul>
    </div>

    <div class="column-18">
      <div class="panel">
        <h2>Queries, Filters and Predicates</h2>
<h3>Building a Query</h3>
<p>The IQuery interface is used to express both simple and extremely very complex structures.</p>
<p>A query must declare the target entity type. This is needed so the query can be routed to the correct backing api.</p>
<table>
<thead>
<tr>
<th>Entity Type</th>
<th>Description and backing API end-point</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>item</code></td>
<td>ArcGIS Portal Item <br> <code>/sharing/rest/search</code></td>
</tr>
<tr>
<td><code>group</code></td>
<td>ArcGIS Portal Group <br> <code>/sharing/rest/community/groups/search</code></td>
</tr>
<tr>
<td><code>user</code></td>
<td>ArcGIS Portal User <br> <code>/sharing/rest/portal/self/users</code></td>
</tr>
</tbody>
</table>
<p><img src="/hub.js/img/query-filter.png" alt="Query Model"></p>
<p>These entities are not currently implemented</p>
<table>
<thead>
<tr>
<th>Entity Type</th>
<th>Description and backing API end-point</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>groupMember</code></td>
<td>ArcGIS Portal Group Users <br> <code>/sharing/rest/community/groups/{id}/userlist</code></td>
</tr>
<tr>
<td><code>event</code></td>
<td>ArcGIS Hub Event</td>
</tr>
<tr>
<td><code>post</code></td>
<td>ArcGIS Hub Discussion Posts</td>
</tr>
</tbody>
</table>
<h2>Query, Filters, Predicates</h2>
<p>A Query contains 1 or more Filters, which contain 1 or more Predicates.</p>
<p>When the query structure is serialized into an API request the following logic is applied:</p>
<p>Within a Query...</p>
<ul>
<li>all Filters are <code>AND</code>ed together</li>
<li>all Predicates within a Filter use the <code>filer.operation</code> to control how they are connected</li>
</ul>
<pre><code class="json">{
  <span class="hljs-attr">"targetEntity"</span>: <span class="hljs-string">"item"</span>,
  <span class="hljs-attr">"filters"</span>: [
    {
      <span class="hljs-attr">"operation"</span>: <span class="hljs-string">"AND"</span>,
      <span class="hljs-attr">"predicates"</span>: [
        {
          <span class="hljs-attr">"group"</span>: <span class="hljs-string">"3ef"</span>
        }
      ]
    }
    {
      <span class="hljs-attr">"operation"</span>: <span class="hljs-string">"OR"</span>,
      <span class="hljs-attr">"predicates"</span>: [
        {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Web Map"</span>
        },
        {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Hub Site"</span>
        }
      ]
    }
  ]
}
</code></pre>
<p>Reads as:</p>
<ul>
<li>Search for items,
<ul>
<li>in <code>group</code> &quot;3ef&quot; AND</li>
<li><code>type</code> = &quot;Web Map&quot; OR <code>type</code> = &quot;Hub Site&quot;</li>
</ul>
</li>
</ul>
<p>We can also express this more concisely as:</p>
<pre><code class="json">{
  <span class="hljs-attr">"targetEntity"</span>: <span class="hljs-string">"item"</span>,
  <span class="hljs-attr">"filters"</span>: [
    {
      <span class="hljs-attr">"operation"</span>: <span class="hljs-string">"AND"</span>,
      <span class="hljs-attr">"predicates"</span>: [
        {
          <span class="hljs-comment">// Properties within a predicate are AND'ed unless</span>
          <span class="hljs-comment">// an `IMatchOptions` structure is used, which allows</span>
          <span class="hljs-comment">// more precise control</span>
          <span class="hljs-attr">"group"</span>: <span class="hljs-string">"3ef"</span>,
          <span class="hljs-attr">"type"</span>: {
            <span class="hljs-attr">"any"</span>: [<span class="hljs-string">"Web Map"</span>, <span class="hljs-string">"Hub Site"</span>]
          }
        }
      ]
    }
  ]
}
</code></pre>
<p>In this example we see that a property on an <code>IPredicate</code> can be a string, or an <code>IMatchOptions</code></p>
<h3>Using MatchOptions</h3>
<p>As noted above, most predicate properties will work with a <code>IMatchOptions</code> structure, which allows more specificity with how the query is serialized for the backing API.</p>
<pre><code class="json">{
  <span class="hljs-attr">"targetEntity"</span>: <span class="hljs-string">"item"</span>,
  <span class="hljs-attr">"filters"</span>: [
    {
      <span class="hljs-attr">"operation"</span>: <span class="hljs-string">"AND"</span>,
      <span class="hljs-attr">"predicates"</span>: [
        {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Feature Service"</span>,
          <span class="hljs-attr">"tag"</span>: {
            <span class="hljs-attr">"all"</span>: [<span class="hljs-string">"authoritative"</span>],
            <span class="hljs-attr">"any"</span>: [<span class="hljs-string">"water"</span>, <span class="hljs-string">"lake"</span>],
            <span class="hljs-attr">"not"</span>: [<span class="hljs-string">"rivers"</span>]
          }
        }
      ]
    }
  ]
}
</code></pre>
<p>This reads as:</p>
<ul>
<li>search for items
<ul>
<li>of type <code>Feature Service</code></li>
<li>WITH tag <code>authoritative</code></li>
<li>AND tag <code>water</code> OR tag <code>lake</code></li>
<li>WITHOUT tag <code>rivers</code></li>
</ul>
</li>
</ul>
<p>We can combine predicates via the <code>.operation</code> to construct more complex queries</p>
<pre><code class="json">{
  <span class="hljs-attr">"targetEntity"</span>: <span class="hljs-string">"item"</span>,
  <span class="hljs-attr">"filters"</span>: [
    {
      <span class="hljs-attr">"operation"</span>: <span class="hljs-string">"OR"</span>,
      <span class="hljs-attr">"predicates"</span>: [
        {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Feature Service"</span>,
          <span class="hljs-attr">"tag"</span>: {
            <span class="hljs-attr">"all"</span>: [<span class="hljs-string">"authoritative"</span>],
            <span class="hljs-attr">"any"</span>: [<span class="hljs-string">"water"</span>, <span class="hljs-string">"lake"</span>],
            <span class="hljs-attr">"not"</span>: [<span class="hljs-string">"rivers"</span>]
          }
        },
        {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Web Map"</span>,
          <span class="hljs-attr">"tag"</span>: {
            <span class="hljs-attr">"all"</span>: [<span class="hljs-string">"authoritative"</span>],
            <span class="hljs-attr">"any"</span>: [<span class="hljs-string">"wildfire"</span>, <span class="hljs-string">"fire"</span>]
          },
          <span class="hljs-attr">"owner"</span>: <span class="hljs-string">"jsmith"</span>
        }
      ]
    }
  ]
}
</code></pre>
<p>This reads as:</p>
<ul>
<li>search for items
<ul>
<li>of type <code>Feature Service</code></li>
<li>WITH tag <code>authoritative</code></li>
<li>AND tag <code>water</code> OR tag <code>lake</code></li>
<li>WITHOUT tag <code>rivers</code></li>
<li>OR</li>
<li>of type <code>Web Map</code></li>
<li>WITH tag <code>authoritative</code></li>
<li>AND tag <code>wildfire</code> OR tag <code>fire</code></li>
<li>owned by <code>jsmith</code></li>
</ul>
</li>
</ul>
<h2>Predicate Properties</h2>
<p>Although the <code>IPredicate</code> structure allows for any key, value combinations, the following table lists the properties and their allowed types, for queries being serialized to the ArcGIS Portal API.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Entity</th>
<th>Allowed Types</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>access</code></td>
<td><code>item</code>, <code>group</code>, <code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>bbox</code></td>
<td><code>item</code></td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>categories</code></td>
<td><code>item</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>created</code></td>
<td><code>item</code>, <code>group</code>, <code>user</code></td>
<td><code>IDateRange&lt;number&gt;</code> <code>IRelativeDate</code></td>
</tr>
<tr>
<td><code>description</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>user</code></td>
<td>boolean</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>emailstatus</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>firstname</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>fullname</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>group</code></td>
<td><code>item</code>, <code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>isInvitationOnly</code></td>
<td><code>group</code></td>
<td>boolean</td>
</tr>
<tr>
<td><code>isopendata</code></td>
<td><code>group</code></td>
<td>boolean</td>
</tr>
<tr>
<td><code>joined</code></td>
<td><code>group</code></td>
<td><code>IDateRange&lt;number&gt;</code> <code>IRelativeDate</code></td>
</tr>
<tr>
<td><code>lastlogin</code></td>
<td><code>user</code></td>
<td><code>IDateRange&lt;number&gt;</code> <code>IRelativeDate</code></td>
</tr>
<tr>
<td><code>lastname</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>memberType</code></td>
<td><code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>modified</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>IDateRange&lt;number&gt;</code> <code>IRelativeDate</code></td>
</tr>
<tr>
<td><code>orgid</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>owner</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>provider</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>searchUserAccess</code></td>
<td><code>groupMember</code></td>
<td><code>&quot;member&quot;</code></td>
</tr>
<tr>
<td><code>searchUserName</code></td>
<td><code>groupMember</code></td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>snippet</code></td>
<td><code>item</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code>item</code>,<code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>term</code></td>
<td><code>item</code>, <code>group</code>, <code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>item</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>typekeywords</code></td>
<td><code>item</code>, <code>group</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>userlicensetype</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>user</code></td>
<td><code>string</code>, <code>string[]</code>, <code>IMatchOptions</code></td>
</tr>
</tbody>
</table>
      </div>
    </div>
  </div>

      </main>
    </div>

    <footer class="footer">
      
      <div class="panel panel-white">
        <div class="grid-container">
          <div class="column-24">
            <a href="https://github.com/Esri/hub.js" class="font-size--2">Fork this project</a>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/js/calcite-web.min.js"></script>

    <script>
       calcite.init()
    </script>

    
  </body>
</html>